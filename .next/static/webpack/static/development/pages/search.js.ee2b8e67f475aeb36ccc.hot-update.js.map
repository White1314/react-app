{"version":3,"file":"static/webpack/static\\development\\pages\\search.js.ee2b8e67f475aeb36ccc.hot-update.js","sources":["webpack:///./server/utils.js"],"sourcesContent":["const axios = require('axios');\r\nconst atob = require('atob');\r\n\r\nglobal.atob = atob;\r\n\r\nconst BASE_URL = 'https://api.github.com';\r\n\r\nconst getApiData = async (ctx, path) => {\r\n  // 判断当前为请求环境为服务端还是客户端（网页刷新和链接跳转）\r\n  let isServer = typeof window === 'undefined';\r\n\r\n  // 客户端请求没有 session (ctx.req.session)，需代理到服务器上\r\n  if (!isServer) {\r\n    // 转发到客户端\r\n    url = `/api${path}`;\r\n    const result = await axios({ url });\r\n    let data = result ? result.data : [];\r\n    console.log(data);\r\n    return data;\r\n  } else {\r\n    url = `${BASE_URL}${path}`;\r\n    // 服务端可直接获取 session\r\n    const { oauth } = ctx.session || '';\r\n    const { token_type, access_token } = oauth ? oauth : {};\r\n    let headers = oauth\r\n      ? {\r\n          Authorization: `${token_type} ${access_token}`,\r\n        }\r\n      : {};\r\n    const result = await axios({\r\n      url,\r\n      method: 'get',\r\n      headers,\r\n    }).catch((err) => {});\r\n    console.log('服务端获取数据成功');\r\n    let data = result ? result.data : [];\r\n    return data;\r\n  }\r\n};\r\n\r\nmodule.exports = {\r\n  getApiData,\r\n};\r\n"],"mappings":";;;;;;;;;;;AAAA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AAPA;AAAA;AAQA;AAAA;AACA;AATA;AAQA;AACA;AACA;AAVA;AACA;AADA;AAaA;AACA;AAdA;AAAA;AAiBA;AAEA;AADA;AAlBA;AAAA;AAuBA;AACA;AACA;AAHA;AACA;AAvBA;AAsBA;AAKA;AACA;AA5BA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAgCA;AACA;AADA;;;;;A","sourceRoot":""}